<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>ç‚¹èµç»„ä»¶</title>
</head>
<body>
    <div class='wrapper'>

    </div>
  </body>
  <script>
//   const button = document.querySelector('.like-btn')
//   const buttonText = button.querySelector('.like-text')
//   let isLiked = false 
//   button.addEventListener('click',() => {
//       isLiked = !isLiked
//       if(isLiked) {
//           buttonText.innerHTML = 'å–æ¶ˆ'
//       }else{
//           buttonText.innerHTML = 'ç‚¹èµ'
//       }
//   },false)
// ç¼ºç‚¹ï¼Ÿ DOMåŒ– åº•å±‚ 
// å»DOMåŒ– å»æ„å»ºä¸€ä¸ªè™šæ‹ŸDOMèŠ‚ç‚¹ åœ¨reacté‡Œå°±æ˜¯ç”±react react-dom
// åˆ©ç”¨ç»„ä»¶åŒ–å®ç°å¤ç”¨ 
// ç±»åŒ– <==> React|Vue.Component
// .vue .jsx æ–¹ä¾¿æ€§å¼ºäºä¸€èˆ¬çš„ç±»åŒ–
// äº‹ä»¶ï¼Ÿ


// const createDOMFromString = (domString) => {
//     const div = document.createElement('div')
//     div.innerHTML = domString
//     return div
// }
// DOM èŠ‚ç‚¹çš„éƒ¨åˆ†æ›´æ–° ç•Œé¢å°±äº§ç”Ÿäº†çŠ¶æ€ 
// hot-reload ä¸æ˜¯domçš„æ›´æ–°(æ¶‰åŠåˆ°é‡æ’å’Œé‡ç»˜)è€Œæ˜¯è™šæ‹ŸDOM(åœ¨å†…å­˜ä¹‹ä¸­)çš„æ›´æ–° ä¼šåœ¨ä¸€å®šçš„æ›´æ–°ä¹‹åï¼ŒåŒæ­¥åˆ°DOMçš„ç»“ç‚¹
// class LikeButton {
//     constructor (){
//         this.state = {
//             isLike: false
//         }
//     }
//     render() {
//         this.el = createDOMFromString(`
//             <button id='like-btn'>
//                 <span class="like-text">${this.state.isLiked?'å–æ¶ˆ':'ç‚¹èµ'}</span>
//                 <span>ğŸ‘</span>
//             </button>
//         `)
//          this.el.addEventListener('click', this.changeLikeText.bind(this), false)
//       return this.el
//     }
//     //åªè¦è°ƒç”¨ setStateï¼Œç»„ä»¶å°±ä¼šé‡æ–°æ¸²æŸ“
//     setState (state) {
//       this.state = state
//       const oldEl = this.el
//       // new el
//       this.el = this.render()
//       if(this.onStateChange)
//       this.onStateChange(oldEl,this.el)
//     }
//     changeLikeText () {
//         // çŠ¶æ€æ”¹å˜ -> ç•Œé¢ä¹Ÿè·Ÿç€å˜ï¼Ÿ
//         // å†æ‰§è¡Œä¸€æ¬¡render
//         this.setState({
//           isLiked: !this.state.isLiked
//         })
//       }
    
// }
// const wrapper = document.querySelector('.wrapper')
// const likeButton1 = new LikeButton()
// wrapper.appendChild(likeButton1.render())// ç¬¬ä¸€æ¬¡æ’å…¥ DOM å…ƒç´ 
// // è€çš„ç»“ç‚¹è¿˜åœ¨domä¸Šï¼Œæ–°çš„ç»“ç‚¹å·²ç»å‡†å¤‡å¥½ï¼Œæ²¡æœ‰æŒ‚è½½ä¸Šå»
// likeButton1.onStateChange =(oldEl,newEl) => {
//     wrapper.insertBefore(newEl,oldEl)
//     wrapper.removeChild(oldEl)
// }
const createDOMFromString = (domString) => {
    const div = document.createElement('div')
    div.innerHTML = domString
    return div
}
//å…¶å®å°±æ˜¯æŠŠç»„ä»¶çš„ DOM å…ƒç´ æ’å…¥é¡µé¢ï¼Œå¹¶ä¸”åœ¨ setState çš„æ—¶å€™æ›´æ–°é¡µé¢
const mount = (component, wrapper) => {
    wrapper.appendChild(
        component._renderDOM()
    )
    component.onStateChange =
     (oldEl, newEl) => {
        wrapper.insertBefore(newEl, oldEl)
        wrapper.removeChild(oldEl)
    }
}
class Component {
    constructor (props = {}) {
        this.props = props
    }
    setState (state) {
        const oldEl = this.el
        this.state = state
        this.el = this._renderDOM()
        // åŠ¨æ€è¯­è¨€ è¿è¡Œè¿‡ç¨‹ä¸­åŠ¨æ€æ·»åŠ æ–¹æ³•æˆ–å±æ€§
        if(this.onStateChange) {
            this.onStateChange(oldEl, this.el)
        }
    }
    _renderDOM () {
        // å­ç±»ï¼Œ ä¸€å®šå¾—æä¾›renderæ–¹æ³•
        // renderè§£æ”¾ UI html
        this.el = createDOMFromString(
            this.render()
        )
        if(this.onClick) {
            this.el.addEventListener('click', this.onClick.bind(this), false)
        }
        return this.el
    }
}

class LikeButton extends Component {
   constructor (props) {
       super(props)
       this.state = {
           isLiked: false
       }
   } 
   onClick () {
       this.setState({
           isLiked: !this.state.isLiked
       })
   }
   render () {
       return `
        <button id='like-btn' style="background-color:${this.props.bgColor}">
            <span class="like-text">${this.state.isLiked?'å–æ¶ˆ':'ç‚¹èµ'}</span>
            <span>ğŸ‘</span>
        </button>
       `
   }
}

mount(new LikeButton({bgColor: 'grey'}),document.querySelector('.wrapper'))

  </script>
</html>
